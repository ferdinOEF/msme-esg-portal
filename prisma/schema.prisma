generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"           // production on Vercel => Postgres/Neon
  url      = env("DATABASE_URL")    // DO NOT inline a URL in env()
}

// prisma/schema.prisma (excerpt)
model Scheme {
  id           String   @id @default(cuid())
  name         String   @unique
  shortCode    String?
  type         String
  authority    String
  description  String
  benefits     String?
  eligibility  String?
  documentsUrl String?
  tags         String    // comma-separated
  linksFrom    Link[]    @relation("fromLinks")
  linksTo      Link[]    @relation("toLinks")
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  files        File[]
}

model File {
  id        String   @id @default(cuid())
  schemeId  String
  scheme    Scheme   @relation(fields: [schemeId], references: [id])
  filename  String
  url       String
  status    String   // 'Uploaded' | 'Pending'
  createdAt DateTime @default(now())
}


model Link {
  id       String  @id @default(cuid())

  fromId   String
  toId     String
  relation String
  note     String?

  from     Scheme  @relation("fromLinks", fields: [fromId], references: [id])
  to       Scheme  @relation("toLinks", fields: [toId], references: [id])
}

model LegalDoc {
  id           String   @id @default(cuid())
  title        String
  jurisdiction String
  sector       String?
  locationTag  String?
  summary      String
  url          String?
  tags         String   // CSV: "air,consents,cpcb" (was String[])

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Template {
  id          String   @id @default(cuid())
  title       String
  category    String   // "audit" | "checklist" | "policy" | "eia"
  contentMd   String
  downloadUrl String?

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model CompanySubmission {
  id          String   @id @default(cuid())
  name        String
  udyam       String?
  sector      String
  size        String   // "Micro" | "Small" | "Medium"
  turnoverCr  Float?
  state       String
  district    String?
  compliance  String   // CSV: "consents:valid, iso14001:no" (was String[])

  createdAt   DateTime @default(now())
}
