generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"            // For local dev. In prod, set DATABASE_URL to Postgres if you prefer.
  url      = env("postgresql://neondb_owner:npg_nM9Jo5yBhdbU@ep-old-rice-adh63loq-pooler.c-2.us-east-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require")
}

model Scheme {
  id           String   @id @default(cuid())
  name         String   @unique
  shortCode    String?
  type         String   // "scheme" | "certification" | "framework"
  authority    String
  pillar       String   // CSV: "E,S,G" (was String[])
  description  String
  benefits     String?
  eligibility  String?
  documentsUrl String?
  tags         String   // CSV: "finance,green,sidbi" (was String[])

  // Graph edges
  linksFrom    Link[]   @relation("fromLinks")
  linksTo      Link[]   @relation("toLinks")

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Link {
  id       String  @id @default(cuid())

  fromId   String
  toId     String
  relation String
  note     String?

  from     Scheme  @relation("fromLinks", fields: [fromId], references: [id])
  to       Scheme  @relation("toLinks", fields: [toId], references: [id])
}

model LegalDoc {
  id           String   @id @default(cuid())
  title        String
  jurisdiction String
  sector       String?
  locationTag  String?
  summary      String
  url          String?
  tags         String   // CSV: "air,consents,cpcb" (was String[])

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Template {
  id          String   @id @default(cuid())
  title       String
  category    String   // "audit" | "checklist" | "policy" | "eia"
  contentMd   String
  downloadUrl String?

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model CompanySubmission {
  id          String   @id @default(cuid())
  name        String
  udyam       String?
  sector      String
  size        String   // "Micro" | "Small" | "Medium"
  turnoverCr  Float?
  state       String
  district    String?
  compliance  String   // CSV: "consents:valid, iso14001:no" (was String[])

  createdAt   DateTime @default(now())
}
